{"ast":null,"code":"import _regeneratorRuntime from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import{useController}from'../../Controller';import reviewClasses from'./reviewClasses';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Review(_ref){var review=_ref.review,user=_ref.user;var _useController=useController(),deleteReview=_useController.deleteReview,updateReview=_useController.updateReview,getAllReviews=_useController.getAllReviews;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editing=_useState2[0],setEditing=_useState2[1];var _useState3=useState({body:review.body,author:review.author}),_useState4=_slicedToArray(_useState3,2),formData=_useState4[0],setFormData=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setIsLoading=_useState8[1];function handleChange(evt){setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},evt.target.name,evt.target.value)));}var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return deleteReview(review._id);case 2:case\"end\":return _context.stop();}},_callee);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(evt){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:evt.preventDefault();setIsLoading(true);_context2.prev=2;_context2.next=5;return updateReview(review._id,formData,user);case 5:_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](2);setError('Editing Failed - Try Again');case 10:setEditing(false);case 11:case\"end\":return _context2.stop();}},_callee2,null,[[2,7]]);}));return function handleSubmit(_x){return _ref3.apply(this,arguments);};}();useEffect(function(){function fetchReviews(){return _fetchReviews.apply(this,arguments);}function _fetchReviews(){_fetchReviews=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getAllReviews();case 2:setIsLoading(false);case 3:case\"end\":return _context3.stop();}},_callee3);}));return _fetchReviews.apply(this,arguments);}fetchReviews();},[isLoading]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:reviewClasses.container,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between gap-4\",children:[user._id===review.user&&/*#__PURE__*/_jsx(\"p\",{className:reviewClasses.edit,onClick:function onClick(){setEditing(!editing);},children:\"Edit\"}),user._id===review.user&&/*#__PURE__*/_jsx(\"span\",{className:reviewClasses.delete,onClick:handleDelete,children:\"\\u2715\"})]}),editing?/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:reviewClasses.form,children:[/*#__PURE__*/_jsxs(\"div\",{className:reviewClasses.section,children:[/*#__PURE__*/_jsx(\"label\",{className:reviewClasses.label,htmlFor:\"body\",children:\"Edit Review\"}),/*#__PURE__*/_jsx(\"textarea\",{className:reviewClasses.input,rows:\"5\",cols:\"100\",name:\"body\",placeholder:review.body,value:formData.body,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{className:reviewClasses.section,children:[/*#__PURE__*/_jsx(\"label\",{className:reviewClasses.label,htmlFor:\"author\",children:\"Author\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"author\",className:reviewClasses.input,placeholder:review.author,value:formData.author,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\xA0\",error]}),/*#__PURE__*/_jsx(\"button\",{className:reviewClasses.button,type:\"submit\",children:\"Submit Changes\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:review.body}),/*#__PURE__*/_jsx(\"p\",{className:\"self-end italic\",children:review.author})]})]})});}","map":{"version":3,"names":["useState","useEffect","useController","reviewClasses","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Review","_ref","review","user","_useController","deleteReview","updateReview","getAllReviews","_useState","_useState2","_slicedToArray","editing","setEditing","_useState3","body","author","_useState4","formData","setFormData","_useState5","_useState6","error","setError","_useState7","_useState8","isLoading","setIsLoading","handleChange","evt","_objectSpread","_defineProperty","target","name","value","handleDelete","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","_id","stop","apply","arguments","handleSubmit","_ref3","_callee2","_callee2$","_context2","preventDefault","t0","_x","fetchReviews","_fetchReviews","_callee3","_callee3$","_context3","children","className","container","edit","onClick","delete","onSubmit","form","section","label","htmlFor","input","rows","cols","placeholder","onChange","type","button"],"sources":["/home/matthew/Developer/ga/unit_3/projects/movie-app/src/components/Review/Review.jsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { useController } from '../../Controller'\n\nimport reviewClasses from './reviewClasses'\n\nexport default function Review({ review, user }) {\n  const { deleteReview, updateReview, getAllReviews } = useController()\n\n  const [editing, setEditing] = useState(false)\n  const [formData, setFormData] = useState({\n    body: review.body,\n    author: review.author,\n  })\n  const [error, setError] = useState('')\n  const [isLoading, setIsLoading] = useState(true)\n\n  function handleChange(evt) {\n    setFormData({ ...formData, [evt.target.name]: evt.target.value })\n  }\n\n  const handleDelete = async () => {\n    await deleteReview(review._id)\n  }\n\n  const handleSubmit = async (evt) => {\n    evt.preventDefault()\n    setIsLoading(true)\n    try {\n      await updateReview(review._id, formData, user)\n    } catch {\n      setError('Editing Failed - Try Again')\n    }\n    setEditing(false)\n  }\n\n  useEffect(() => {\n    async function fetchReviews() {\n      await getAllReviews()\n      setIsLoading(false)\n    }\n    fetchReviews()\n  }, [isLoading])\n\n  return (\n    <>\n      <div className={reviewClasses.container}>\n        <div className=\"flex justify-between gap-4\">\n          {user._id === review.user && (\n            <p\n              className={reviewClasses.edit}\n              onClick={() => {\n                setEditing(!editing)\n              }}\n            >\n              Edit\n            </p>\n          )}\n          {user._id === review.user && (\n            <span className={reviewClasses.delete} onClick={handleDelete}>\n              &#10005;\n            </span>\n          )}\n        </div>\n        {editing ? (\n          <form onSubmit={handleSubmit} className={reviewClasses.form}>\n            <div className={reviewClasses.section}>\n              <label className={reviewClasses.label} htmlFor=\"body\">\n                Edit Review\n              </label>\n              <textarea\n                className={reviewClasses.input}\n                rows=\"5\"\n                cols=\"100\"\n                name=\"body\"\n                placeholder={review.body}\n                value={formData.body}\n                onChange={handleChange}\n              />\n            </div>\n            <div className={reviewClasses.section}>\n              <label className={reviewClasses.label} htmlFor=\"author\">\n                Author\n              </label>\n              <input\n                type=\"text\"\n                name=\"author\"\n                className={reviewClasses.input}\n                placeholder={review.author}\n                value={formData.author}\n                onChange={handleChange}\n              />\n            </div>\n            <p>&nbsp;{error}</p>\n            <button className={reviewClasses.button} type=\"submit\">\n              Submit Changes\n            </button>\n          </form>\n        ) : (\n          <div className=\"flex flex-col\">\n            <p className=\"text-lg\">{review.body}</p>\n            <p className=\"self-end italic\">{review.author}</p>\n          </div>\n        )}\n      </div>\n    </>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}