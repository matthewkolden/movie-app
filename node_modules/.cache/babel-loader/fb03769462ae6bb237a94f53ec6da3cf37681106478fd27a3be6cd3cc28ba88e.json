{"ast":null,"code":"import _regeneratorRuntime from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/matthew/Developer/ga/unit_3/projects/movie-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import*as usersAPI from'./usersApi';export function signUp(_x){return _signUp.apply(this,arguments);}function _signUp(){_signUp=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(userData){var token;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return usersAPI.signUp(userData);case 2:token=_context.sent;// Persist the token to localStorage\nlocalStorage.setItem('token',token);return _context.abrupt(\"return\",getUser());case 5:case\"end\":return _context.stop();}},_callee);}));return _signUp.apply(this,arguments);}export function login(_x2){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(credentials){var token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return usersAPI.login(credentials);case 2:token=_context2.sent;// Persist the token to localStorage\nlocalStorage.setItem('token',token);return _context2.abrupt(\"return\",getUser());case 5:case\"end\":return _context2.stop();}},_callee2);}));return _login.apply(this,arguments);}export function getToken(){var token=localStorage.getItem('token');// getItem will return null if no key\nif(!token)return null;var payload=JSON.parse(atob(token.split('.')[1]));if(payload.exp<Date.now()/1000){// Token has expired\nlocalStorage.removeItem('token');return null;}return token;}export function getUser(){var token=getToken();return token?JSON.parse(atob(token.split('.')[1])).user:null;}export function logOut(){localStorage.removeItem('token');}","map":{"version":3,"names":["usersAPI","signUp","_x","_signUp","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","userData","token","wrap","_callee$","_context","prev","next","sent","localStorage","setItem","abrupt","getUser","stop","login","_x2","_login","_callee2","credentials","_callee2$","_context2","getToken","getItem","payload","JSON","parse","atob","split","exp","Date","now","removeItem","user","logOut"],"sources":["/home/matthew/Developer/ga/unit_3/projects/movie-app/src/services/usersService.js"],"sourcesContent":["import * as usersAPI from './usersApi'\n\nexport async function signUp(userData) {\n  const token = await usersAPI.signUp(userData)\n  // Persist the token to localStorage\n  localStorage.setItem('token', token)\n  return getUser()\n}\n\nexport async function login(credentials) {\n  const token = await usersAPI.login(credentials)\n  // Persist the token to localStorage\n  localStorage.setItem('token', token)\n  return getUser()\n}\n\nexport function getToken() {\n  const token = localStorage.getItem('token')\n  // getItem will return null if no key\n  if (!token) return null\n  const payload = JSON.parse(atob(token.split('.')[1]))\n  if (payload.exp < Date.now() / 1000) {\n    // Token has expired\n    localStorage.removeItem('token')\n    return null\n  }\n  return token\n}\n\nexport function getUser() {\n  const token = getToken()\n  return token ? JSON.parse(atob(token.split('.')[1])).user : null\n}\n\nexport function logOut() {\n  localStorage.removeItem('token')\n}\n"],"mappings":"oSAAA,MAAO,GAAK,CAAAA,QAAQ,KAAM,YAAY,CAEtC,eAAsB,CAAAC,MAAMA,CAAAC,EAAA,SAAAC,OAAA,CAAAC,KAAA,MAAAC,SAAA,GAK3B,SAAAF,QAAA,EAAAA,OAAA,CAAAG,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CALM,SAAAC,QAAsBC,QAAQ,MAAAC,KAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAE,IAAA,SACf,CAAAhB,QAAQ,CAACC,MAAM,CAACS,QAAQ,CAAC,QAAvCC,KAAK,CAAAG,QAAA,CAAAG,IAAA,CACX;AACAC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAER,KAAK,CAAC,QAAAG,QAAA,CAAAM,MAAA,UAC7BC,OAAO,EAAE,0BAAAP,QAAA,CAAAQ,IAAA,MAAAb,OAAA,GACjB,UAAAN,OAAA,CAAAC,KAAA,MAAAC,SAAA,GAED,eAAsB,CAAAkB,KAAKA,CAAAC,GAAA,SAAAC,MAAA,CAAArB,KAAA,MAAAC,SAAA,GAK1B,SAAAoB,OAAA,EAAAA,MAAA,CAAAnB,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CALM,SAAAkB,SAAqBC,WAAW,MAAAhB,KAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAgB,UAAAC,SAAA,iBAAAA,SAAA,CAAAd,IAAA,CAAAc,SAAA,CAAAb,IAAA,SAAAa,SAAA,CAAAb,IAAA,SACjB,CAAAhB,QAAQ,CAACuB,KAAK,CAACI,WAAW,CAAC,QAAzChB,KAAK,CAAAkB,SAAA,CAAAZ,IAAA,CACX;AACAC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAER,KAAK,CAAC,QAAAkB,SAAA,CAAAT,MAAA,UAC7BC,OAAO,EAAE,0BAAAQ,SAAA,CAAAP,IAAA,MAAAI,QAAA,GACjB,UAAAD,MAAA,CAAArB,KAAA,MAAAC,SAAA,GAED,MAAO,SAAS,CAAAyB,QAAQA,CAAA,CAAG,CACzB,GAAM,CAAAnB,KAAK,CAAGO,YAAY,CAACa,OAAO,CAAC,OAAO,CAAC,CAC3C;AACA,GAAI,CAACpB,KAAK,CAAE,MAAO,KAAI,CACvB,GAAM,CAAAqB,OAAO,CAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACxB,KAAK,CAACyB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACrD,GAAIJ,OAAO,CAACK,GAAG,CAAGC,IAAI,CAACC,GAAG,EAAE,CAAG,IAAI,CAAE,CACnC;AACArB,YAAY,CAACsB,UAAU,CAAC,OAAO,CAAC,CAChC,MAAO,KAAI,CACb,CACA,MAAO,CAAA7B,KAAK,CACd,CAEA,MAAO,SAAS,CAAAU,OAAOA,CAAA,CAAG,CACxB,GAAM,CAAAV,KAAK,CAAGmB,QAAQ,EAAE,CACxB,MAAO,CAAAnB,KAAK,CAAGsB,IAAI,CAACC,KAAK,CAACC,IAAI,CAACxB,KAAK,CAACyB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACK,IAAI,CAAG,IAAI,CAClE,CAEA,MAAO,SAAS,CAAAC,MAAMA,CAAA,CAAG,CACvBxB,YAAY,CAACsB,UAAU,CAAC,OAAO,CAAC,CAClC"},"metadata":{},"sourceType":"module","externalDependencies":[]}